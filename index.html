<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุธู</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Blind Mode Button -->
    <button class="blind-mode-btn" id="blindModeBtn" title="ุงููุถุน ุงูุฃุนูู">
        <svg viewBox="0 0 24 24">
            <path d="M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M12,4.5C17,4.5 21.27,7.61 23,12C21.27,16.39 17,19.5 12,19.5C7,19.5 2.73,16.39 1,12C2.73,7.61 7,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C12.69,17.5 13.37,17.43 14,17.29L11.72,15C10.29,14.85 9.15,13.71 9,12.28L5.6,8.87C4.61,9.72 3.78,10.78 3.18,12Z" />
            <path class="eye-slash" d="M2,5.27L3.28,4L20,20.72L18.73,22L15.65,18.92C14.5,19.3 13.28,19.5 12,19.5C7,19.5 2.73,16.39 1,12C1.69,10.24 2.79,8.69 4.19,7.46L2,5.27M12,9A3,3 0 0,1 15,12C15,12.35 14.94,12.69 14.83,13L11,9.17C11.31,9.06 11.65,9 12,9M12,4.5C17,4.5 21.27,7.61 23,12C22.18,14.08 20.79,15.88 19,17.19L17.58,15.76C18.94,14.82 20.06,13.54 20.82,12C19.17,8.64 15.76,6.5 12,6.5C10.91,6.5 9.84,6.68 8.84,7L7.3,5.47C8.74,4.85 10.33,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C12.69,17.5 13.37,17.43 14,17.29L11.72,15C10.29,14.85 9.15,13.71 9,12.28L5.6,8.87C4.61,9.72 3.78,10.78 3.18,12Z" style="display:none;" />
        </svg>
    </button>
    
    <!-- Streak Counter -->
    <div class="streak-counter" id="streakCounter" style="display: none;">
        <span class="fire-icon">๐ฅ</span>
        <span id="streakCount">0</span>
    </div>
    
    <div class="container">
        <div class="page creation-page active-page">
            <h2>ุงุฎุชุจุงุฑ ุงููุฏุฑุงุช - ุงููุณู ุงูููุธู</h2>
            
            <div class="options-selector">
                <div class="mastery-distribution-container">
                    <h3>ุชูุฒูุน ูุณุจ ุงูุฅุชูุงู</h3>
                    <div class="chart-container">
                        <canvas id="masteryDistributionChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="questionTypesChart"></canvas>
                    <div class="chart-total">
                        <span>ูุณุจ</span>
                        <span>ุงูุฃุณุฆูุฉ</span>
                    </div>
                </div>
                
                <div class="question-type-sliders">
                    <div class="slider-container analogy-type">
                        <div class="slider-header">
                            <span class="slider-label">
                                <span class="slider-color-dot"></span>
                                ุชูุงุธุฑ
                            </span>
                            <div class="slider-controls">
                                <span class="slider-value" id="analogyTypeValue">20%</span>
                                <button class="lock-type-btn" title="ููู ูุฐุง ุงููุณู" data-type="analogy">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </button>
                                <button class="delete-type-btn" title="ุญุฐู ูุฐุง ุงููุณู" data-type="analogy">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <input type="range" class="slider-input" id="analogyTypeSlider" min="0" max="100" value="20">
                    </div>
                    
                    <div class="slider-container completion-type">
                        <div class="slider-header">
                            <span class="slider-label">
                                <span class="slider-color-dot"></span>
                                ุฅููุงู ุงูุฌูู
                            </span>
                            <div class="slider-controls">
                                <span class="slider-value" id="completionTypeValue">20%</span>
                                <button class="lock-type-btn" title="ููู ูุฐุง ุงููุณู" data-type="completion">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </button>
                                <button class="delete-type-btn" title="ุญุฐู ูุฐุง ุงููุณู" data-type="completion">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <input type="range" class="slider-input" id="completionTypeSlider" min="0" max="100" value="20">
                    </div>
                    
                    <div class="slider-container error-type">
                        <div class="slider-header">
                            <span class="slider-label">
                                <span class="slider-color-dot"></span>
                                ุงูุฎุทุฃ ุงูุณูุงูู
                            </span>
                            <div class="slider-controls">
                                <span class="slider-value" id="errorTypeValue">20%</span>
                                <button class="lock-type-btn" title="ููู ูุฐุง ุงููุณู" data-type="error">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </button>
                                <button class="delete-type-btn" title="ุญุฐู ูุฐุง ุงููุณู" data-type="error">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <input type="range" class="slider-input" id="errorTypeSlider" min="0" max="100" value="20">
                    </div>
                    
                    <div class="slider-container comprehension-type">
                        <div class="slider-header">
                            <span class="slider-label">
                                <span class="slider-color-dot"></span>
                                ุงุณุชูุนุงุจ ุงูููุฑูุก
                            </span>
                            <div class="slider-controls">
                                <span class="slider-value" id="comprehensionTypeValue">20%</span>
                                <button class="lock-type-btn" title="ููู ูุฐุง ุงููุณู" data-type="comprehension">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </button>
                                <button class="delete-type-btn" title="ุญุฐู ูุฐุง ุงููุณู" data-type="comprehension">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <input type="range" class="slider-input" id="comprehensionTypeSlider" min="0" max="100" value="20">
                    </div>
                    
                    <div class="slider-container vocabulary-type">
                        <div class="slider-header">
                            <span class="slider-label">
                                <span class="slider-color-dot"></span>
                                ุงูููุฑุฏุฉ ุงูุดุงุฐุฉ
                            </span>
                            <div class="slider-controls">
                                <span class="slider-value" id="vocabularyTypeValue">20%</span>
                                <button class="lock-type-btn" title="ููู ูุฐุง ุงููุณู" data-type="vocabulary">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </button>
                                <button class="delete-type-btn" title="ุญุฐู ูุฐุง ุงููุณู" data-type="vocabulary">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <input type="range" class="slider-input" id="vocabularyTypeSlider" min="0" max="100" value="20">
                    </div>
                </div>
                
                <div class="question-count">
                    <label for="questionCount">ุนุฏุฏ ุงูุฃุณุฆูุฉ:</label>
                    <input type="number" id="questionCount" min="5" max="1000" value="50">
                </div>
                
                <div class="question-count">
                    <label for="testDuration">ููุช ุงูุงุฎุชุจุงุฑ (ุฏูุงุฆู):</label>
                    <input type="number" id="testDuration" min="1" max="1000" value="9">
                </div>
                
                <div class="question-count">
                    <label for="maxMasteryLimit">ูุณุจุฉ ุงูุฅุชูุงู ูุง ุชุฒูุฏ ุนู:</label>
                    <input type="number" id="maxMasteryLimit" min="0" max="100" value="99">
                    <span class="input-suffix">%</span>
                </div>

                <div class="time-per-question" id="timePerQuestion">
                    ุงูููุช ุงููุฎุตุต ููู ุณุคุงู: 1:30 ุฏูููุฉ
                </div>
                
                <label class="checkbox-option">
                    <input type="checkbox" id="markedOnly">
                    <span>ุงูุฃุณุฆูุฉ ุงููุนูููุฉ ููุท</span>
                    <span class="marked-count" id="markedCount">(0)</span>
                </label>
                
                <label class="checkbox-option">
                    <input type="checkbox" id="excludeMarked">
                    <span>ุงุณุชุซูุงุก ุงูุฃุณุฆูุฉ ุงููุนูููุฉ</span>
                </label>
                
                <label class="checkbox-option">
                    <input type="checkbox" id="autoAdvance">
                    <span>ุงูุงูุชูุงู ุงูุชููุงุฆู ููุณุคุงู ุงูุชุงูู</span>
                </label>
                
                <label class="checkbox-option">
                    <input type="checkbox" id="freeRunnerMode">
                    <span>ุงููุถุน ุงูุญุฑ (Free Runner)</span>
                </label>
                
                <label class="checkbox-option">
                    <input type="checkbox" id="stealthMode">
                    <span>ุงููุถุน ุงูุฎูู</span>
                </label>
                
                <div class="time-per-question free-runner-info" id="freeRunnerInfo" style="display: none;">
                    ุงููุถุน ุงูุญุฑ: ุงุฎุชุจุงุฑ ููุชูุญ ุจุฏูู ููุช ูุญุฏุฏุ ููููู ุงูุงุณุชูุฑุงุฑ ุญุชู ุชูุฑุฑ ุงูุงูุชูุงุก
                </div>
                
                <div class="mastery-info-container" id="masteryInfoContainer">
                    <div class="mastery-info-title">ุงูุฅุชูุงู 100%</div>
                    <div class="mastery-info-content">
                        ุงูุฅุฌุงุจุงุช ุงููุทููุจุฉ: <span id="requiredCorrectAnswers">...</span>
                        | ุงูุฃุณุฆูุฉ: <span id="totalQuestionsCount">...</span>
                    </div>
                </div>
            </div>
            
            <button class="nav-btn" id="startQuizBtn">ุจุฏุก ุงูุงุฎุชุจุงุฑ</button>
        </div>

        <button class="undo-delete" id="undoDeleteBtn">
            <svg viewBox="0 0 24 24">
                <path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"/>
            </svg>
            <span>ุงูุชุฑุงุฌุน ุนู ุงูุญุฐู</span>
        </button>
        
        <div class="custom-alert-overlay" id="customAlertOverlay">
            <div class="custom-alert">
                <div class="custom-alert-icon" id="alertIcon">โ</div>
                <div class="custom-alert-content">
                    <span class="custom-alert-title" id="alertTitle">ุชูุจูู</span>
                    <span id="alertContent">ูุญุชูู ุงูุชูุจูู</span>
                </div>
                <div class="custom-alert-buttons">
                    <button class="custom-alert-btn secondary" id="alertCancelBtn">ุฅูุบุงุก</button>
                    <button class="custom-alert-btn primary" id="alertConfirmBtn">ุชุฃููุฏ</button>
                </div>
            </div>
        </div>

        <div class="mobile-tooltip" id="mobileTooltip"></div>
        
        <!-- Emergency Pause Overlay -->
        <div class="emergency-pause-overlay" id="emergencyPauseOverlay">
            <div class="emergency-pause-content">
                <div class="emergency-pause-icon">โธ๏ธ</div>
                <h2 class="emergency-pause-title">ุชููู ูุคูุช ููุงุฎุชุจุงุฑ</h2>
                <p class="emergency-pause-message">ุชู ุฅููุงู ุงูุงุฎุชุจุงุฑ ูุคูุชูุง. ููููู ุงุณุชุฆูุงู ุงูุงุฎุชุจุงุฑ ุนูุฏ ุงูุงุณุชุนุฏุงุฏ.</p>
                <div class="emergency-pause-timer" id="pauseTimer">00:00</div>
                <p class="emergency-pause-remaining" id="emergencyPauseRemaining">ูุชุจูู ูุฏูู 0 ุฅููุงู ูู ุฃุตู 0</p>
                <button class="emergency-pause-button" id="resumeButton">ุงุณุชุฆูุงู ุงูุงุฎุชุจุงุฑ</button>
            </div>
        </div>

        <div class="page quiz-page">
            <div class="remaining-time-per-question" id="remainingTimePerQuestion">
                <span class="time-standard" id="timeStandard"></span>
                <span class="time-difference" id="timeDifference"></span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill" id="progressBarFill"></div>
                <div class="progress-text" id="progressText">ุงูุฃุณุฆูุฉ ุงููุญูููุฉ: 0/0</div>
            </div>
            <div class="total-timer" id="totalTimer">ุงูููุช ุงููุชุจูู: 00:00</div>
            <div id="questionsContainer"></div>
            <div class="navigation-buttons">
                <button class="nav-btn" id="prevBtn">ุงูุณุงุจู</button>
                <button class="nav-btn" id="nextBtn">ุงูุชุงูู</button>
                <button class="nav-btn" id="submitBtn" style="display: none;">ุชุณููู</button>
            </div>
            
            <div class="stats-widget" id="statsWidget">
                <div class="stats-widget-content">
                    <div class="stats-item">
                        <span class="dot correct"></span>
                        <span id="widgetCorrect">0</span>
                    </div>
                    <div class="stats-item">
                        <span class="dot wrong"></span>
                        <span id="widgetWrong">0</span>
                    </div>
                    <div class="stats-item">
                        <span class="dot unanswered"></span>
                        <span id="widgetUnanswered">0</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="page results-page">
            <div class="score-summary">
                <div class="unified-chart-container">
                    <div class="unified-chart" id="resultsChart"></div>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color correct"></div>
                            <span id="correctCount">0 ุตุญูุญุฉ</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color wrong"></div>
                            <span id="wrongCount">0 ุฎุงุทุฆุฉ</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color unanswered"></div>
                            <span id="unansweredCount">0 ุบูุฑ ูุฌุงุจุฉ</span>
                        </div>
                    </div>
                    <div class="final-score" id="finalScore"></div>
                </div>
            </div>
            
            <div class="time-stats-section">
                <h3>ุฅุญุตุงุฆูุงุช ุงูููุช:</h3>
                <div class="time-stats-container">
                    <div class="time-stat-item">
                        <div class="time-stat-icon">โฑ</div>
                        <div class="time-stat-value" id="averageTimePerQuestion">0 ุซุงููุฉ</div>
                        <div class="time-stat-label">ูุชูุณุท ุงูููุช ููู ุณุคุงู</div>
                    </div>
                    <div class="time-stat-item">
                        <div class="time-stat-icon">โณ</div>
                        <div class="time-stat-value" id="totalTimeSpent">0 ุซุงููุฉ</div>
                        <div class="time-stat-label">ุฅุฌูุงูู ุงูููุช ุงููุณุชุบุฑู</div>
                    </div>
                    <div class="time-stat-item">
                        <div class="time-stat-icon">๐</div>
                        <div class="time-stat-value" id="fastestAnswer">0 ุซุงููุฉ</div>
                        <div class="time-stat-label">ุฃุณุฑุน ุฅุฌุงุจุฉ</div>
                    </div>
                    <div class="time-stat-item">
                        <div class="time-stat-icon">๐</div>
                        <div class="time-stat-value" id="slowestAnswer">0 ุซุงููุฉ</div>
                        <div class="time-stat-label">ุฃุจุทุฃ ุฅุฌุงุจุฉ</div>
                    </div>
                    <div class="time-stat-item">
                        <div class="time-stat-icon">โก</div>
                        <div class="time-stat-value" id="speedRate">0 ุซุงููุฉ</div>
                        <div class="time-stat-label">ูุนุฏู ุงูุณุฑุนุฉ</div>
                    </div>
                    <div class="time-stat-item">
                        <div class="time-stat-icon">๐ฅ</div>
                        <div class="time-stat-value" id="highestStreak">0</div>
                        <div class="time-stat-label">ุฃุนูู ุณุชุฑูู</div>
                    </div>
                </div>
            </div>

            <div class="marked-section">
                <h3>ุงูุฃุณุฆูุฉ ุงููุนูููุฉ:</h3>
                <button class="copy-all-btn" id="copyAllMarkedBtn">
                    <svg viewBox="0 0 24 24">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                        <path d="M19,7H5V5H19V7ZM3,5H11V19H3V5Z"/>
                    </svg>
                    ูุณุฎ ุงูุฃุณุฆูุฉ ุงููุนูููุฉ
                </button>
                <div id="markedQuestionsDetails"></div>
            </div>

            <div class="wrong-questions-section">
                <h3>ุงูุฃุณุฆูุฉ ุงูุฎุงุทุฆุฉ ูุบูุฑ ุงููุฌุงุจุฉ:</h3>
                <div id="wrongQuestionsDetails"></div>
            </div>
            
            <button class="nav-btn" id="restartQuizBtn">ุฅุนุงุฏุฉ ุงููุญุงููุฉ</button>
        </div>
    </div>

    <div class="time-bar" id="timeBar"></div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
